(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{LYUz:function(t,n,e){"use strict";e.r(n),e.d(n,"MountsModule",(function(){return T}));var i=e("ofXK"),o=e("FTbq"),c=e("aceb"),s=e("3Pt+"),u=e("tyNb"),r=e("wd/R"),a=e("LRne"),l=e("lJxs"),d=e("fXoL"),h=e("XNiG"),m=e("itXk"),p=e("JYL7"),g=e("L7Zs");let b=(()=>{class t{constructor(t){this.connectService=t,this.listTrigger=new h.a,this.addTrigger=new h.a,this.unmountTrigger=new h.a;const n=this;this.list$=new class extends p.k{constructor(){super(...arguments),this.prerequest$=Object(m.a)([n.listTrigger,n.connectService.listCmd$.verify(this.cmd)],(t,n)=>n)}},this.list$.deploy(),this.add$=new class extends p.m{constructor(){super(...arguments),this.prerequest$=Object(m.a)([n.addTrigger,n.connectService.listCmd$.verify(this.cmd)],(t,n)=>[Object.assign(Object.assign({},n[0]),t),n[1]])}},this.add$.deploy(),this.add$.getOutput().subscribe(t=>{0===t[1].length&&this.refreshList()}),this.unmount$=new class extends p.n{constructor(){super(...arguments),this.prerequest$=Object(m.a)([n.unmountTrigger,n.connectService.listCmd$.verify(this.cmd)],(t,n)=>[Object.assign(Object.assign({},n[0]),t),n[1]])}},this.unmount$.deploy(),this.unmount$.getOutput().subscribe(t=>{0===t[1].length&&this.refreshList()})}refreshList(){this.list$.clearCache(),this.listTrigger.next(1)}mount(t){this.addTrigger.next(t)}unmount(t){this.unmountTrigger.next(t)}}return t.\u0275fac=function(n){return new(n||t)(d.ic(g.a))},t.\u0275prov=d.Ub({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const f=["mountTypeInp"];function M(t,n){if(1&t){const t=d.fc();d.ec(0,"td"),d.Uc(1),d.dc(),d.ec(2,"td"),d.Uc(3),d.dc(),d.ec(4,"td"),d.Uc(5),d.dc(),d.ec(6,"td"),d.ec(7,"button",3),d.mc("click",(function(){d.Kc(t);const e=n.$implicit;return d.oc().unmount(e)})),d.Zb(8,"nb-icon",4),d.dc(),d.dc()}if(2&t){const t=n.$implicit;d.Mb(1),d.Vc(t.Fs),d.Mb(2),d.Vc(t.MountPoint),d.Mb(2),d.Vc(t.MountedTimeHumanReadable)}}function y(t,n){if(1&t&&(d.ec(0,"nb-option",14),d.Uc(1),d.dc()),2&t){const t=n.$implicit;d.wc("value",t),d.Mb(1),d.Wc(" ",t," ")}}function w(t,n){if(1&t){const t=d.fc();d.ec(0,"th"),d.ec(1,"input",5),d.mc("ngModelChange",(function(n){return d.Kc(t),d.oc().newMount.fs=n})),d.dc(),d.dc(),d.ec(2,"th"),d.ec(3,"input",6),d.mc("ngModelChange",(function(n){return d.Kc(t),d.oc().newMount.mountPoint=n})),d.dc(),d.dc(),d.ec(4,"th"),d.ec(5,"input",7,8),d.mc("input",(function(){return d.Kc(t),d.oc().onMountTypeInpChange()})),d.dc(),d.ec(7,"nb-autocomplete",9,10),d.mc("selectedChange",(function(n){return d.Kc(t),d.oc().onMountTypeInpSecChange(n)})),d.Sc(9,y,2,2,"nb-option",11),d.pc(10,"async"),d.dc(),d.dc(),d.ec(11,"th"),d.ec(12,"button",12),d.mc("click",(function(){return d.Kc(t),d.oc().mount()})),d.Zb(13,"nb-icon",13),d.dc(),d.dc()}if(2&t){const t=d.Gc(8),n=d.oc();d.Mb(1),d.wc("ngModel",n.newMount.fs),d.Mb(2),d.wc("ngModel",n.newMount.mountPoint),d.Mb(2),d.wc("nbAutocomplete",t),d.Mb(4),d.wc("ngForOf",d.qc(10,4,n.filteredOptions$))}}const O=[{path:"",component:(()=>{class t{constructor(t,n){this.mountService=t,this.toastr=n,this.scrb=[],this.columns=[{key:"Fs",title:"Filesystem",width:"37.5%"},{key:"MountPoint",title:"Mounted point",width:"37.5%"},{key:"MountedTimeHumanReadable",title:"Mounted time",width:"20%"},{key:"",title:"Action",width:"5%"}],this.data=[],this.newMount={fs:"",mountPoint:"",mountType:""}}filter(t){const n=t.toLowerCase();return this.options.filter(t=>t.toLowerCase().includes(n))}getFilteredOptions(t){return Object(a.a)(t).pipe(Object(l.a)(t=>this.filter(t)))}onMountTypeInpChange(){this.newMount.mountType=this.mountTypeInp.nativeElement.value,this.filteredOptions$=this.getFilteredOptions(this.mountTypeInp.nativeElement.value)}onMountTypeInpSecChange(t){this.filteredOptions$=this.getFilteredOptions(t)}refresh(){this.mountService.refreshList()}mount(){this.mountService.mount(this.newMount)}unmount(t){this.unmountItem=t,this.mountService.unmount({mountPoint:t.MountPoint})}ngOnInit(){this.scrb.push(this.mountService.list$.getOutput().subscribe(t=>{this.configuration.isLoading=!1,0===t[1].length?this.data=t[0].mountPoints.map(t=>Object.assign(Object.assign({},t),{MountedTimeHumanReadable:r(t.MountedOn).fromNow()})):this.toastr.danger(t[1].join(" \n"),"fetch mounts list failure",{icon:"list-tree",iconPack:"css.gg",destroyByClick:!0,duration:0})})),this.scrb.push(this.mountService.add$.getOutput().subscribe(t=>{0===t[1].length||this.toastr.danger(t[1].join(" \n"),"Create mount point failure",{icon:"alert-triangle-outline"})})),this.scrb.push(this.mountService.unmount$.getOutput().subscribe(t=>{0===t[1].length?(this.newMount.fs=this.unmountItem.Fs,this.newMount.mountPoint=this.unmountItem.MountPoint,this.newMount.mountType="",this.toastr.success(this.unmountItem.MountPoint,"Unmount actived mount successfully",{icon:"checkmark-circle-outline"})):this.toastr.danger(t[1].join(" \n"),"Unmount actived mount failure",{icon:"alert-triangle-outline"})})),this.refresh(),this.configuration=Object.assign({},o.c),this.configuration.searchEnabled=!1,this.configuration.isLoading=!0,this.options=["mount","cmount","mount2"],this.filteredOptions$=Object(a.a)(this.options)}ngOnDestroy(){this.scrb.forEach(t=>t.unsubscribe()),this.scrb=[]}}return t.\u0275fac=function(n){return new(n||t)(d.Yb(b),d.Yb(c.ib))},t.\u0275cmp=d.Sb({type:t,selectors:[["app-mounts"]],viewQuery:function(t,n){var e;1&t&&d.Zc(f,!0),2&t&&d.Fc(e=d.nc())&&(n.mountTypeInp=e.first)},decls:9,vars:4,consts:[["icon","sync",3,"click"],[3,"configuration","data","columns","filtersTemplate"],["filtersTemplate",""],["nbButton","","status","danger","size","small",3,"click"],["icon","close-outline"],["type","text","nbInput","","fullWidth","","fieldSize","small","placeholder","remote path to be mounted",3,"ngModel","ngModelChange"],["type","text","nbInput","","fullWidth","","fieldSize","small","placeholder","path on server machine",3,"ngModel","ngModelChange"],["nbInput","","type","text","fullWidth","","fieldSize","small","placeholder","mount type",3,"nbAutocomplete","input"],["mountTypeInp",""],[3,"selectedChange"],["auto",""],[3,"value",4,"ngFor","ngForOf"],["nbButton","","status","info","size","small",3,"click"],["icon","plus-outline"],[3,"value"]],template:function(t,n){if(1&t&&(d.ec(0,"nb-card"),d.ec(1,"nb-card-header"),d.Uc(2," Mount Point Manager "),d.ec(3,"nb-icon",0),d.mc("click",(function(){return n.refresh()})),d.dc(),d.dc(),d.ec(4,"nb-card-body"),d.ec(5,"ngx-table",1),d.Sc(6,M,9,3,"ng-template"),d.dc(),d.dc(),d.dc(),d.Sc(7,w,14,6,"ng-template",null,2,d.Tc)),2&t){const t=d.Gc(8);d.Mb(5),d.wc("configuration",n.configuration)("data",n.data)("columns",n.columns)("filtersTemplate",t)}},directives:[c.r,c.u,c.C,c.q,o.b,c.n,c.F,s.a,s.e,s.h,c.j,c.i,i.n,c.R],pipes:[i.b],styles:["nb-card-header[_ngcontent-%COMP%] {\n\t\t\t\tdisplay: flex;\n\t\t\t}\n\t\t\tnb-card-header[_ngcontent-%COMP%]    > nb-icon[_ngcontent-%COMP%] {\n\t\t\t\tmargin-left: auto;\n\t\t\t}"]}),t})()}];let v=(()=>{class t{}return t.\u0275mod=d.Wb({type:t}),t.\u0275inj=d.Vb({factory:function(n){return new(n||t)},imports:[[u.g.forChild(O)],u.g]}),t})(),T=(()=>{class t{}return t.\u0275mod=d.Wb({type:t}),t.\u0275inj=d.Vb({factory:function(n){return new(n||t)},imports:[[i.c,v,o.d,c.v,c.E,c.G,c.k,c.o,s.b]]}),t})()}}]);